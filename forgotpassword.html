<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forgot Password</title><!-- title of the page -->
    <link rel="stylesheet" href="styles.css">

    <script type="module">
        //firebase stuff
        // import the Firebase Authentication module
        import { getAuth, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";

        // Your Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyBS_v9aLKtqD03F538WLS0SbR3Tb2Y2Gtg",
          authDomain: "calendarproj-d7815.firebaseapp.com",
          projectId: "calendarproj-d7815",
          storageBucket: "calendarproj-d7815.firebasestorage.app",
          messagingSenderId: "991723469626",
          appId: "1:991723469626:web:3af4fd59015bc768e56e03",
          measurementId: "G-S065L5SMJV"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);  // Initialize Firebase Authentication
    </script>
</head>
<body>
    <div class="forgot-password-container">
        <h2>Forgot Password</h2><!-- title for the page -->
        <form id="forgot-password-form">
            <label for="email">Enter your email</label><!-- email input label -->
            <input type="email" id="email" name="email" required><!-- input for email -->

            <button type="submit">Reset Password</button><!-- submit button -->
        </form>

        <p>Remember your password? <a href="signin.html">Sign In</a></p><!-- link back to sign-in page -->
    </div>

    <script>
        // handle the password reset process when the form is submitted
        document.getElementById('forgot-password-form').addEventListener('submit', function(e) {
            e.preventDefault(); // prevent the default form submission

            const email = document.getElementById('email').value; // get the email entered by the user

            // send password reset email using Firebase Authentication
            sendPasswordResetEmail(auth, email)
                .then(() => {
                    // email sent successfully
                    alert('Password reset email sent! Check your inbox to reset your password.');
                    window.location.href = 'signin.html'; // redirect to sign-in page after email is sent
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error(errorCode, errorMessage);
                    alert('Error: ' + errorMessage); // show error if the email is not sent successfully
                });
        });
    </script>
</body>
</html>
